# Simple workflow for deploying static content to GitHub Pages
name: Deploy static content to Pages

on:
  # Runs on pushes targeting the default branch
  push:
    branches: ["<html lang="en"><head>
        <meta charset="UTF-8">
        <title>Ruffle Player</title>
        <meta name="robots" content="noindex, nofollow">
        <style>
            html, body {
                margin: 0;
                padding: 0;
                height: 100%;
                overflow: hidden;
            }
        </style>
    </head>
    <body>
        <div id="container"><ruffle-player style="width: 100vw; height: 100vh;"></ruffle-player></div>

        <script>
            window.RufflePlayer = window.RufflePlayer || {};
            window.RufflePlayer.config = {
                "autoplay": "on",
                "contextMenu": false,
                "unmuteOverlay": "hidden",
                "preloader": true,
                "--preloader-background": "#000000"
            };
            document.addEventListener("DOMContentLoaded", function () {
                let swf = 'whack-your-ex.swf';
                if (swf) {
                    let ruffle = window.RufflePlayer.newest();
                    let player = Object.assign(document.getElementById("container").appendChild(ruffle.createPlayer()), {
                        style: 'width: 100vw; height: 100vh',
                    });

                    player.load({
                        url: '/' + swf,
                        parameters: ""
                    });
                }
            });
        </script>
        <script src="23012023/ruffle.js"></script>
    
</body></html>"]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow one concurrent deployment
concurrency:
  group: "pages"
  cancel-in-progress: true

jobs:
  # Single deploy job since we're just deploying
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Setup Pages
        uses: actions/configure-pages@v3
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v1
        with:
          # Upload entire repository
          path: '.'
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v1
